with raw as (

                  SELECT  "rskcsp_ds_cardholder"  as table_name, Count(*) cnt FROM dmn01-rsksoi-bld-01-2017.dmn01_rsksoi_euwe2_rsk_csp_downstream_raw.rskcsp_ds_cardholder union all
                  SELECT "rskcsp_ds_loan" table_name, Count(*) cnt FROM dmn01-rsksoi-bld-01-2017.dmn01_rsksoi_euwe2_rsk_csp_downstream_raw.rskcsp_ds_loan union all
                  SELECT "rskcsp_ds_limit" table_name, Count(*) cnt FROM dmn01-rsksoi-bld-01-2017.dmn01_rsksoi_euwe2_rsk_csp_downstream_raw.rskcsp_ds_limit union all
                  SELECT "rskcsp_ds_legal_entities" table_name, Count(*) cnt  FROM dmn01-rsksoi-bld-01-2017.dmn01_rsksoi_euwe2_rsk_csp_downstream_raw.rskcsp_ds_legal_entities ),
       staging as (
                  SELECT "rskcsp_ds_cardholder" as table_name, count(1) as count  FROM dmn01-rsksoi-bld-01-2017.dmn01_rsksoi_euwe2_rsk_csp_ds_staging.rskcsp_ds_cardholder_staging union all
                  SELECT "rskcsp_ds_limit" as table_name, count(1)  FROM dmn01-rsksoi-bld-01-2017.dmn01_rsksoi_euwe2_rsk_csp_ds_staging.rskcsp_ds_limit_staging union all
                  SELECT "rskcsp_ds_loan" as table_name, count(1)  FROM dmn01-rsksoi-bld-01-2017.dmn01_rsksoi_euwe2_rsk_csp_ds_staging.rskcsp_ds_loan_staging union all
                  SELECT "rskcsp_ds_legal_entities" as table_name, count(1)  FROM dmn01-rsksoi-bld-01-2017.dmn01_rsksoi_euwe2_rsk_csp_ds_staging.rskcsp_ds_legal_entities_staging),
       Curated as (SELECT "rskcsp_ds_cardholder" as table_name, count(1) as count  FROM  dmn01-rsksoi-bld-01-2017.dmn01_rsksoi_euwe2_rsk_csp_ds_curation.rskcsp_ds_cardholder_curated union all
                                       SELECT "rskcsp_ds_limit" as table_name, count(1)  AS COUNT FROM  dmn01-rsksoi-bld-01-2017.dmn01_rsksoi_euwe2_rsk_csp_ds_curation.rskcsp_ds_limit_curated union all
                                       SELECT "rskcsp_ds_loan" as table_name, count(1) AS COUNT FROM  dmn01-rsksoi-bld-01-2017.dmn01_rsksoi_euwe2_rsk_csp_ds_curation.rskcsp_ds_loan_curated union all
                                       SELECT "rskcsp_ds_legal_entities" as table_name, count(1)   AS COUNT FROM  dmn01-rsksoi-bld-01-2017.dmn01_rsksoi_euwe2_rsk_csp_ds_curation.rskcsp_ds_legal_entities_curated 
),
 CONSUMPTION as (SELECT "rskcsp_ds_cardholder" as table_name, count(1) as count  FROM  dmn01-rsksoi-bld-01-2017.dmn01_rsksoi_euwe2_rsk_csp_ds_consumption.cardholder union all

                                       SELECT "rskcsp_ds_loan" as table_name, count(1) AS COUNT FROM  dmn01-rsksoi-bld-01-2017.dmn01_rsksoi_euwe2_rsk_csp_ds_consumption.loan union all
                                       SELECT "rskcsp_ds_legal_entities" as table_name, count(1)   AS COUNT FROM  dmn01-rsksoi-bld-01-2017.dmn01_rsksoi_euwe2_rsk_csp_ds_consumption.legal_entities union all
                                       SELECT "rskcsp_ds_limit" as table_name, count(1) AS COUNT FROM  dmn01-rsksoi-bld-01-2017.dmn01_rsksoi_euwe2_rsk_csp_ds_consumption.limit )
                  select a.table_name, b.cnt raw_layer_count, a.count staging_layer_count , c.count curated_layer_count 
                  ,D.COUNT AS CONSUMPTION_LAYER_COUNT from staging A, RAW B, curated c , CONSUMPTION D
                  WHERE A.TABLE_NAME = B.TABLE_NAME and a.table_name = c.table_name
                  AND A.TABLE_NAME = D.TABLE_NAME ORDER BY 1;
